package vulntest;

import reporting.entry.Entry;
import reporting.entry.Group;
import reporting.entry.SingleStringEntry;
import reporting.entry.ThrowableEntry;

public class VulnerabilityTestException extends Exception {

    private final Entry errorReport;

    public VulnerabilityTestException(Entry errorReport) {
        this.errorReport = errorReport;
    }

    public VulnerabilityTestException(Entry errorReport, Throwable e) {
        this.errorReport = errorReport;
        this.errorReport.addSubEntry(new ThrowableEntry(e));
    }

    public VulnerabilityTestException(String what, Throwable e) {
        errorReport = new Group(what);
        errorReport.addSubEntry(new ThrowableEntry(e));
    }

    public VulnerabilityTestException(String what) {
        errorReport = new SingleStringEntry(what);
    }

    public Entry getErrorReport() {
        return errorReport;
    }
}
